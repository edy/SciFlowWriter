
<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<script src="/static/js/jquery.js"></script>
		<script type="text/javascript">
		$(function(){
			$.getJSON('/profile', function(data) {
				
				$('#image').append('<img src="'+data.image+'" />');
				$('#name').append(data.name);

				$.each(data.pads.my, function(i, v) {
					$('#mypads').append('<li><a href="/p/'+v+'">'+v+'</a> (<a class="invitelink" href="/profile/invite?name='+v+'">create invite link</a>)</li>');
				});

				$.each(data.pads.other, function(i, v) {
					$('#otherpads').append('<li><a href="/p/'+v+'">'+v+'</a></li>');
				});

				$.each(data.pads.review, function(i, v) {
					$('#reviewpads').append('<li><a href="/p/'+v+'">'+v+'</a></li>');
				});

			});

			$('#newpad').on('click', function(e){
				var name = prompt('Please name your pad:', 'my cool pad');
				
				if (name !== null) {
					$.getJSON('/profile/newpad?name='+name, function(data){
						$('#mypads').append('<li><a href="'+data.uri+'">'+data.padID+'</a> (<a class="invitelink" href="/profile/invite?name='+data.padID+'">create invite link</a>)</li>');
					});
				}

				return false;
			});

			$('.invitelink').live('click', function(e) {
				var email = prompt('Send inlite mail to:', '');
				console.log(this);
				if (email !== null) {
					$.getJSON(this.href, {'email':email}, function(data){
						alert('Sent email with link: '+data.url)
					});
				}

				return false;
			});
		});
		</script>
	</head>
	<body>
		<h1>Profile</h1>
		<p><span id="image"></span> <strong><span id="name"></span></strong></p>

		<ul>
			<li><strong>My Pads:</strong> (<a id="newpad" href="#">new pad</a>)
				<ul id="mypads"></ul>
			</li>
			<li><strong>Other Pads:</strong>
				<ul id="otherpads"></ul>
			</li>
			<!--li>Review Pads:
				<ul id="mypads"></ul></li-->
		</ul>

	</body>
</html>